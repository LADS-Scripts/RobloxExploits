names = {'Keep','Four-Way','Pipe','Distributor Cap','T-Junction','Distributor','Fabricator','Wall','Elbow','Cap','Spawn Point','Turret','Arc Turret','Automechanic','Shield Generator',};
    attachments = {'FemaleFlange3','FemaleFlange1','FemaleFlange2','FemaleFlange4','FemaleFlange','WallSnap1','WallSnap2',};
    local cf = function(xp, yp, zp, xr, yr, zr)
    return cfn(xp, yp, zp)*cfa(xr,yr,zr)
end
cfn, cfa = CFrame.new, CFrame.fromEulerAnglesYXZ
local tbl = {{1,cf(0.078,22.3,-1.301,-0.29,-0,0),0,nil,nil,nil,nil},{1,cf(0.4,55.35,-9.951,0,3.142,-0),0,nil,nil,nil,nil},{1,cf(0.537,89.194,-12.112,-0.29,-0,0),0,nil,nil,nil,nil},{1,cf(0.676,122.244,-21.239,-0,3.142,-0),0,nil,nil,nil,nil},{2,cf(5.2,-1.058,2.461,1.571,1.571,0),0,nil,nil,nil,nil},{3,cf(7,18.863,4.976,-1.309,-0,-1.571),3,5,1,nil,nil},{2,cf(0,-2.1,0.8,1.571,3.142,0),1,2,5,1,nil},{4,cf(-0.155,-0.4,0.58,-1.571,-0.262,0),1,3,5,nil,nil},{4,cf(-0.155,-0.4,0.58,-1.571,-0.262,0),1,3,7,nil,nil},{4,cf(-0.424,-0.4,0.424,-1.571,-0.785,0),1,2,7,nil,nil},{4,cf(0.155,-0.4,0.58,-1.571,0.262,0),1,4,7,nil,nil},{4,cf(0.155,-0.4,0.58,-1.571,0.262,0),1,4,5,nil,nil},{3,cf(7.077,40.781,-3.7720000000000002,-1.281,-3.141,1.571),3,6,3,nil,nil},{3,cf(7.399,64.346,-7.646,-1.571,-1.571,0),3,13,3,nil,nil},{3,cf(7.399,83.501,-5.76,-1.571,-1.571,0),3,14,3,nil,nil},{3,cf(7.537,92.31,-9.104000000000001,-1.281,-3.141,1.571),3,15,3,nil,nil},{5,cf(0.8,-2.1,-0,1.571,-1.571,0),1,3,16,1,nil},{6,cf(5.936,108.367,-20.751,1.281,0,-1.571),0,nil,nil,nil,nil},{3,cf(0,0,0,-0,0,0),2,17,18,3,5},{3,cf(7.5360000000000005,113.47200000000001,-15.135,-1.543,-3.14,1.57),3,17,2,nil,nil},{3,cf(7.675,137.193,-18.488,-1.571,-1.571,0),3,20,3,nil,nil},{7,cf(-4.563,89.946,-15.233,1.543,0.001,1.572),0,nil,nil,nil,nil},{4,cf(-0.6,-0.4,0,-1.571,-1.571,0),1,5,22,nil,nil},{7,cf(-4.564,98.059,-15.562000000000001,-1.543,-3.14,-1.572),0,nil,nil,nil,nil},{4,cf(-0.52,-0.4,0.3,-1.571,-1.047,0),1,5,24,nil,nil},{8,cf(-4.824,126.97,-21.5,-1.571,1.571,0),0,nil,nil,nil,nil},{8,cf(-8,-2,-0,0,-3.142,-0),1,6,26,7,nil},{8,cf(-3.8160000000000003,126.943,-37.474000000000004,1.571,1.571,0),0,nil,nil,nil,nil},{9,cf(0.8,-1,-0.5750000000000001,0,-3.142,-1.571),1,3,21,3,nil},{3,cf(3.301,138.14000000000001,-26.238,0,-1.571,1.571),3,29,2,nil,nil},{3,cf(-4.317,133.76500000000001,-34.095,-0,-3.142,-0),3,30,3,nil,nil},{2,cf(0.8,-2.1,-0,1.571,-1.571,0),1,3,31,1,nil},{6,cf(6.853,130.367,-36.455,0,-1.571,-0),0,nil,nil,nil,nil},{10,cf(-0.52,-0.4,0.3,-1.571,-1.047,0),1,4,32,nil,nil},{3,cf(0,0,0,-0,0,0),2,32,33,3,5},{11,cf(-11.224,130.392,-21.211000000000002,0,-1.571,-0),0,nil,nil,nil,nil},{4,cf(-0.58,-0.4,-0.155,-1.571,-1.833,0),1,5,36,nil,nil},{12,cf(-19.139,123.446,-28.218,0,0,-3.142),0,nil,nil,nil,nil},{12,cf(13.799,123.421,-38.002,0,0,-3.142),0,nil,nil,nil,nil},{4,cf(-0.6,-0.4,0,-1.571,-1.571,0),1,5,39,nil,nil},{4,cf(-0.579,-0.4,0.155,-1.571,-1.309,0),1,5,38,nil,nil},{13,cf(-17.756,130.392,-25.237000000000002,0,0,0),0,nil,nil,nil,nil},{4,cf(-0.424,-0.4,0.424,-1.571,-0.785,0),1,5,42,nil,nil},{14,cf(-20.484,130.092,-19.587,-0,-3.142,-0),0,nil,nil,nil,nil},{4,cf(-0.6,-0.4,-0,-1.571,-1.571,0),1,5,44,nil,nil},{15,cf(12.537,130.367,-34.933,0,0,0),0,nil,nil,nil,nil},{4,cf(-0.424,-0.4,0.424,-1.571,-0.785,0),1,5,46,nil,nil},{15,cf(-18.761,130.393,-35.956,0,0,0),0,nil,nil,nil,nil},{4,cf(-0.424,-0.4,0.424,-1.571,-0.785,0),1,5,48,nil,nil},{15,cf(-23.488,130.393,-35.97,0,0,0),0,nil,nil,nil,nil},{4,cf(-0.6,-0.4,-0,-1.571,-1.571,0),1,5,50,nil,nil},}


--replace till this line
local remote = game:GetService("ReplicatedStorage").Shared.Remotes.PlaceStructure

local lplr = game:GetService('Players').LocalPlayer
local mouse = lplr:GetMouse()
mouse.Button1Down:Wait()
local base = mouse.Target

local placed = {}
local structures = workspace:WaitForChild('Structures')
local run = game:GetService('RunService')



local areaRadius = base.Size.Magnitude+5
for i, v in ipairs(tbl) do
	areaRadius = math.max(areaRadius, v[2].Position.Magnitude)
end

areaRadius+=5

local p = Instance.new('Part', workspace.CurrentCamera)
p.Anchored = true
p.CanCollide = false
p.Material = Enum.Material.ForceField
p.Shape = Enum.PartType.Ball
p.Size = Vector3.new(2,2,2)*areaRadius
p.Color = Color3.new(1,.2, .2)
p.CFrame = CFrame.new(base.CFrame.Position)
local ppos = base.CFrame.Position
task.delay(60*8, function()
	game.Debris:AddItem(p, 1)
end) 


local a, b = pcall(function()
	for i, v in ipairs(tbl) do
		run.RenderStepped:Wait()
		local name = names[v[1]]
		local placeMode = v[3]
		if placeMode == 0 then
			run.RenderStepped:Wait()
			remote:FireServer(
				name
				,{
					['BasePart'] = base;
					['CFrame'] = v[2]
				}
			)
		elseif placeMode == 1 then
			local needed = nil
			local s = os.clock()+2
			while needed == nil and os.clock()<s do
				for ii, vv in ipairs(placed) do
					print(ii, vv)
				end
				for ii, vv in ipairs(placed[v[5]]:GetDescendants()) do
					if vv:IsA('BasePart') and vv.Name == attachments[ v[4] ] then
						needed = vv
						break
					end
				end
				run.RenderStepped:Wait()
			end
			remote:FireServer(
				name
				,{
					['BasePart'] = needed ;
					['CFrame'] = v[2]
				}
				,attachments[ v[6] or v[4] ]
				,needed
			)
		elseif placeMode == 2 then
			local needed1 = nil
			local s = os.clock()+2
			local cf1, cf2 = v[4], v[5]
			local attach1, attach2 = v[6], v[7]
			while needed1 == nil and os.clock()<s do
				for ii, vv in ipairs(placed[cf1]:GetDescendants()) do
					if vv:IsA('BasePart') and vv.Name == attachments[ attach1 ] then
						needed1 = vv
						break
					end
				end
				run.RenderStepped:Wait()
			end
			local needed2 = nil
			local s = os.clock()+2
			while needed2 == nil and os.clock()<s do
				for ii, vv in ipairs(placed[cf2]:GetDescendants()) do
					if vv:IsA('BasePart') and vv.Name == attachments[ attach2 ] then
						needed2 = vv
						break
					end
				end
				run.RenderStepped:Wait()
			end
			remote:FireServer(
				name
				,{
					[1]={ ['CFrame'] = needed1 };
					[2]= { ['CFrame'] = needed2 };
				}
			)
		elseif placeMode == 3 then
			local needed1 = nil
			local s = os.clock()+2
			local cf, basepart, attahment = v[2] , v[4], v[5]
			local attach1
			while needed1 == nil and os.clock()<s do
				for ii, vv in ipairs(placed[basepart]:GetDescendants()) do
					if vv:IsA('BasePart') and vv.Name == attachments[ attahment ] then
						needed1 = vv
						break
					end
				end
				run.RenderStepped:Wait()
			end
			remote:FireServer(
				name
				,{
					[1]={ ['CFrame'] = needed1 };
					[2]= { ['CFrame'] = cf, BasePart = base };
				}
			)
		end
		--if (model:GetPivot().Position-targetPos).Magnitude<= ( placeMode == 0 and 40 or 40 ) or (model:GetPivot().Position-base.Position).Magnitude <= areaRadius then
		local targetPos = (base.CFrame*v[2]).Position
		local found, s = false, os.clock()+60*5

		local con = structures.ChildAdded:Connect(function(model)
			if model.Name == name and not model:FindFirstChild('IsBlueprint') and not model:WaitForChild('IsBlueprint', .1) then
				
				local ss = os.clock()+2
				while ss>os.clock() and model.PrimaryPart == nil do run.RenderStepped:Wait() end
				if (model:GetPivot().Position-targetPos).Magnitude<= ( placeMode == 0 and 40 or 40 ) or (model:GetPivot().Position-ppos).Magnitude <= areaRadius then
					found = model
				end
			end
		end)
		repeat run.RenderStepped:Wait() until found~=false or os.clock()>s
		con:Disconnect()
		if found then
			placed[i] = found
		end
		
	end
end)

p:Destroy()

print(a, b)



