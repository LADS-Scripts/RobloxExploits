


-- Services
local CollectionService = game:GetService("CollectionService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local lplr = Players.LocalPlayer
local mouse = lplr:GetMouse()

-- Modules
local NetworkingReplicator = require(ReplicatedStorage.Shared.Modules.NetworkingReplicator)


local BillboardGui = Instance.new("BillboardGui")
local TextLabel = Instance.new("TextLabel")

do
    BillboardGui.Parent = game.CoreGui
    BillboardGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    BillboardGui.Active = true
    BillboardGui.AlwaysOnTop = true
    BillboardGui.LightInfluence = 0
    BillboardGui.Size = UDim2.new(0, 200, 0, 50)

    TextLabel.Parent = BillboardGui
    TextLabel.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    TextLabel.BackgroundTransparency = 1.000
    TextLabel.BorderColor3 = Color3.fromRGB(0, 0, 0)
    TextLabel.BorderSizePixel = 0
    TextLabel.Size = UDim2.new(1, 0, 1, 0)
    TextLabel.Font = Enum.Font.SourceSansSemibold
    TextLabel.Text = ""
    TextLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    TextLabel.TextScaled = true
    TextLabel.TextSize = 14.000
    TextLabel.TextStrokeTransparency = 0.300
    TextLabel.TextWrapped = true
end


task.spawn(function()
    while task.wait(.1) do
        BillboardGui.Adornee = nil
        BillboardGui.Parent = nil
        
        local target = mouse.Target
        if not workspace.Blueprints:IsAncestorOf(target) then continue end

        local blueprint = target
        repeat blueprint = blueprint.Parent until blueprint.Parent == workspace.Blueprints

        if not blueprint:GetAttribute('NetworkId') then continue end

        local networkData = NetworkingReplicator.getNetworkAsync(blueprint)
        BillboardGui.Adornee = blueprint
        local p = networkData.storage/networkData.capacity*100
        TextLabel.Text = string.format("%.1f%%   %d/%d",p, networkData.storage,networkData.capacity)

        BillboardGui.Parent = game.CoreGui
    end
end)


local uselessFunction = function(t0, t1)
    t1.Model:Destroy()
end

for i, v in pairs(getgc(true)) do
    if typeof(v) == 'table' then
        if rawget(v, 'effectBlueprintCompleted') then
            rawset(v, 'effectBlueprintCompleted', uselessFunction)
        end
    end
end

game:GetService('RunService'):UnbindFromRenderStep('BlueprintFilling')
game:GetService("ReplicatedStorage").Client.Effects.Swim.Blur.Size = 0
game:GetService("ReplicatedStorage").Client.Effects.Swim.WaterAtmosphere.Density = 0.1
local shitbeam = game:GetService("ReplicatedStorage").Client.Effects.IridiumBeam
shitbeam.Transparency = NumberSequence.new(0,0.86,0,1,0.86,0)
shitbeam.Segments = 1
shitbeam.Width0 = 0.15
shitbeam.Width1 = 0.088
shitbeam.Texture = ''
