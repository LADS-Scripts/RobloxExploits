names = {'Wall','Slab Block','Submersible','Four-Way','T-Junction','Cap','Distributor','Pipe','Spawn Point','Distributor Cap','Fabricator','Arc Turret','Shield Generator','Point Defense','Reservoir','Upgrade Station','Automechanic',};
	attachments = {'FemaleFlange','FemaleFlange3','FemaleFlange1','FemaleFlange2','FemaleFlange4','WallSnap1','WallSnap2',};
	local cf = function(xp, yp, zp, xr, yr, zr)
	return cfn(xp, yp, zp)*cfa(xr,yr,zr)
end
cfn, cfa = CFrame.new, CFrame.fromEulerAnglesYXZ
local tbl = {{1,cf(0.092,-0.35000000000000003,-6.016,0,-0,-0),0,nil,nil,nil,nil},{2,cf(-0.11,26.900000000000002,-1.149,0,0,-0),0,nil,nil,nil,nil},{3,cf(-0.231,28.05,4.108,0,0,-0),0,nil,nil,nil,nil},{4,cf(-0.8,-2.1,0,1.571,1.571,0),1,1,3,2,nil},{4,cf(0,-2.1,0.8,1.571,3.142,0),1,3,4,2,nil},{4,cf(0,-2.1,0.8,1.571,3.142,0),1,3,5,2,nil},{5,cf(0.8,-1.4000000000000001,0,0,3.142,-1.571),1,3,6,4,nil},{6,cf(0.3,-0.4,0.52,-1.571,0.524,0),1,3,7,nil,nil},{6,cf(-0.3,-0.4,0.52,-1.571,-0.524,0),1,5,6,nil,nil},{6,cf(0.155,-0.4,0.58,-1.571,0.262,0),1,4,6,nil,nil},{6,cf(-0.155,-0.4,0.58,-1.571,-0.262,0),1,5,5,nil,nil},{7,cf(0.192,9.38,-9.439,-1.571,-0,0),0,nil,nil,nil,nil},{4,cf(-0.8,-2.1,0,1.571,1.571,0),1,1,12,2,nil},{4,cf(-0.8,-2.1,0,1.571,1.571,0),1,2,7,2,nil},{8,cf(0,0,0,-0,0,0),2,14,13,3,3},{7,cf(3.6270000000000002,6.061,-9.439,-1.571,-0,0),0,nil,nil,nil,nil},{7,cf(-3.427,5.66,-9.439,-1.571,-0,0),0,nil,nil,nil,nil},{8,cf(0,0,0,-0,0,0),2,16,13,1,5},{8,cf(0,0,0,-0,0,0),2,13,17,4,1},{1,cf(-8,-2,0,-0,3.142,0),1,6,1,7,nil},{9,cf(13.229000000000001,18.348,-9.439,0,1.571,-1.571),0,nil,nil,nil,nil},{10,cf(-0.424,-0.4,-0.424,-1.571,-2.356,0),1,1,21,nil,nil},{3,cf(4.511,28.05,9.106,0,0,-0),0,nil,nil,nil,nil},{8,cf(0,0,0,-0,0,0),2,23,4,1,4},{3,cf(-5.469,28.05,9.216000000000001,0,0,-0),0,nil,nil,nil,nil},{8,cf(0,0,0,-0,0,0),2,25,4,1,5},{1,cf(8,-2,0,0,0,0),1,7,1,7,nil},{11,cf(-18.335,4.1370000000000005,-9.139,1.571,-3.142,0),0,nil,nil,nil,nil},{10,cf(-0.6,-0.4,0,-1.571,-1.571,0),1,1,28,nil,nil},{11,cf(-14.034,4.203,-9.139,1.571,-3.142,0),0,nil,nil,nil,nil},{10,cf(-0.6,-0.4,0,-1.571,-1.571,0),1,1,30,nil,nil},{3,cf(-0.157,30.429000000000002,4.093,0,0,-0),0,nil,nil,nil,nil},{4,cf(-0.8,-2.1,0,1.571,1.571,0),1,1,32,2,nil},{4,cf(0,-2.1,0.8,1.571,3.142,0),1,3,33,2,nil},{6,cf(0,-0.4,0.6,-1.571,-0,0),1,3,34,nil,nil},{8,cf(0,0,0,-0,0,0),2,5,34,4,4},{3,cf(4.747,30.429000000000002,9.200000000000001,0,0,-0),0,nil,nil,nil,nil},{8,cf(0,0,0,-0,0,0),2,37,33,1,4},{3,cf(-5.45,30.429000000000002,9.178,0,0,-0),0,nil,nil,nil,nil},{8,cf(0,0,0,-0,0,0),2,39,33,1,5},{11,cf(-18.401,10.201,-9.139,1.571,-3.142,0),0,nil,nil,nil,nil},{10,cf(-0.6,-0.4,0,-1.571,-1.571,0),1,1,41,nil,nil},{11,cf(-14.115,10.261000000000001,-9.139,1.571,-3.142,0),0,nil,nil,nil,nil},{10,cf(-0.6,-0.4,0,-1.571,-1.571,0),1,1,43,nil,nil},{12,cf(-9.864,4.857,-10.483,1.436,3.142,-0),0,nil,nil,nil,nil},{10,cf(-0.6,-0.4,0,-1.571,-1.571,0),1,1,45,nil,nil},{12,cf(10.059000000000001,4.226,-10.568,1.436,3.142,-0),0,nil,nil,nil,nil},{10,cf(-0.3,-0.4,-0.52,-1.571,-2.618,0),1,1,47,nil,nil},{3,cf(-0.155,32.808,3.9610000000000003,0,0,-0),0,nil,nil,nil,nil},{4,cf(-0.8,-2.1,0,1.571,1.571,0),1,1,49,2,nil},{4,cf(0,-2.1,0.8,1.571,3.142,0),1,3,50,2,nil},{8,cf(0,0,0,-0,0,0),2,34,51,5,5},{6,cf(0,-0.4,0.6,-1.571,-0,0),1,3,51,nil,nil},{3,cf(4.931,32.808,9.491,0,0,-0),0,nil,nil,nil,nil},{3,cf(-5.64,32.808,9.19,0,0,-0),0,nil,nil,nil,nil},{8,cf(0,0,0,-0,0,0),2,54,50,1,4},{8,cf(0,0,0,-0,0,0),2,50,55,5,1},{3,cf(-0.198,35.188,4.016,0,0,-0),0,nil,nil,nil,nil},{4,cf(-0.8,-2.1,0,1.571,1.571,0),1,1,58,2,nil},{4,cf(0,-2.1,0.8,1.571,3.142,0),1,3,59,2,nil},{6,cf(-0,-0.4,0.6,-1.571,-0,0),1,3,60,nil,nil},{8,cf(0,0,0,-0,0,0),2,51,60,4,4},{6,cf(-0.155,-0.4,0.58,-1.571,-0.262,0),1,5,60,nil,nil},{3,cf(5.019,35.188,9.664,0,0,-0),0,nil,nil,nil,nil},{3,cf(-5.875,35.188,9.071,0,0,-0),0,nil,nil,nil,nil},{8,cf(0,0,0,-0,0,0),2,65,59,1,5},{8,cf(0,0,0,-0,0,0),2,59,64,4,1},{13,cf(-24.293,20.27,-6.498,-0,0,1.571),0,nil,nil,nil,nil},{13,cf(-24.293,15.27,-6.513,-0,0,1.571),0,nil,nil,nil,nil},{13,cf(-24.293,10.422,-6.5280000000000005,-0,0,1.571),0,nil,nil,nil,nil},{13,cf(-24.293,5.473,-6.569,-0,0,1.571),0,nil,nil,nil,nil},{10,cf(-0.6,-0.4,0,-1.571,-1.571,0),1,1,68,nil,nil},{10,cf(-0.6,-0.4,0,-1.571,-1.571,0),1,1,69,nil,nil},{10,cf(-0.6,-0.4,0,-1.571,-1.571,0),1,1,70,nil,nil},{10,cf(-0.6,-0.4,0,-1.571,-1.571,0),1,1,71,nil,nil},{13,cf(24.477,20.236,-6.564,0,-0,-1.571),0,nil,nil,nil,nil},{13,cf(24.477,15.431000000000001,-6.553,-0,0,-1.571),0,nil,nil,nil,nil},{13,cf(24.477,10.6,-6.538,-0,0,-1.571),0,nil,nil,nil,nil},{13,cf(24.477,5.752,-6.5360000000000005,-0,0,-1.571),0,nil,nil,nil,nil},{10,cf(-0.6,-0.4,0,-1.571,-1.571,0),1,1,76,nil,nil},{10,cf(-0.6,-0.4,0,-1.571,-1.571,0),1,1,77,nil,nil},{10,cf(-0.6,-0.4,0,-1.571,-1.571,0),1,1,78,nil,nil},{10,cf(-0.6,-0.4,0,-1.571,-1.571,0),1,1,79,nil,nil},{14,cf(-13.790000000000001,9.971,-20.639,-0,1.571,-1.571),0,nil,nil,nil,nil},{4,cf(-0.8,-2.1,0,1.57,-0,-1.571),1,1,84,2,nil},{10,cf(0,-0.4,0.6,-1.57,1.651,-1.502),1,3,85,nil,nil},{10,cf(-0.52,-0.4,0.3,-1.571,-1.047,0),1,5,85,nil,nil},{10,cf(0.52,-0.4,0.3,-1.571,1.047,0),1,4,85,nil,nil},{15,cf(-8.275,19.801000000000002,-2.493,0,1.571,1.571),0,nil,nil,nil,nil},{8,cf(-13.141,28.549,-1.962,-0,3.142,-0),3,89,1,nil,nil},{8,cf(-13.56,28.55,-11.189,-0,-3.142,-0),3,90,4,nil,nil},{4,cf(0.8,-2.1,-0,1.571,-1.571,0),1,4,91,2,nil},{8,cf(0,0,0,-0,0,0),2,92,14,4,5},{6,cf(0,-0.4,0.6,-1.571,-0,0),1,3,92,nil,nil},{6,cf(-0.3,-0.4,0.52,-1.571,-0.524,0),1,5,92,nil,nil},{16,cf(10.483,18.306,-10.639,-0,-1.571,1.571),0,nil,nil,nil,nil},{8,cf(0,0,0,-0,0,0),2,96,14,1,4},{17,cf(-10.324,18.567,-9.139,0,1.571,-1.571),0,nil,nil,nil,nil},{10,cf(-0.6,-0.4,0,-1.571,-1.571,0),1,1,98,nil,nil},{17,cf(-19.148,18.613,-9.139,-0,-1.571,1.571),0,nil,nil,nil,nil},{10,cf(-0.58,-0.4,-0.155,-1.571,-1.833,0),1,1,100,nil,nil},{17,cf(15.977,9.091,-9.139,0,-1.571,1.571),0,nil,nil,nil,nil},{10,cf(-0.6,-0.4,0,-1.571,-1.571,0),1,1,102,nil,nil},{17,cf(21.913,14.431000000000001,-9.139,1.571,3.142,0),0,nil,nil,nil,nil},{10,cf(-0.52,-0.4,0.3,-1.571,-1.047,0),1,1,104,nil,nil},}




--replace till this line
local remote = game:GetService("ReplicatedStorage").Shared.Remotes.PlaceStructure

local lplr = game:GetService('Players').LocalPlayer
local mouse = lplr:GetMouse()
mouse.Button1Down:Wait()
local base = mouse.Target

local placed = {}
local structures = workspace:WaitForChild('Structures')
local run = game:GetService('RunService')



local areaRadius = base.Size.Magnitude+5
for i, v in ipairs(tbl) do
	areaRadius = math.max(areaRadius, v[2].Position.Magnitude)
end

areaRadius+=5

local p = Instance.new('Part', workspace.CurrentCamera)
p.Anchored = true
p.CanCollide = false
p.Material = Enum.Material.ForceField
p.Shape = Enum.PartType.Ball
p.Size = Vector3.new(2,2,2)*areaRadius
p.Color = Color3.new(1,.2, .2)
p.CFrame = CFrame.new(base.CFrame.Position)
local ppos = base.CFrame.Position
task.delay(60*8, function()
	game.Debris:AddItem(p, 1)
end) 


local a, b = pcall(function()
	for i, v in ipairs(tbl) do
		run.RenderStepped:Wait()
		local name = names[v[1]]
		local placeMode = v[3]
		if placeMode == 0 then
			run.RenderStepped:Wait()
			remote:FireServer(
				name
				,{
					['BasePart'] = base;
					['CFrame'] = v[2]
				}
			)
		elseif placeMode == 1 then
			local needed = nil
			local s = os.clock()+2
			while needed == nil and os.clock()<s do
				for ii, vv in ipairs(placed) do
					print(ii, vv)
				end
				for ii, vv in ipairs(placed[v[5]]:GetDescendants()) do
					if vv:IsA('BasePart') and vv.Name == attachments[ v[4] ] then
						needed = vv
						break
					end
				end
				run.RenderStepped:Wait()
			end
			remote:FireServer(
				name
				,{
					['BasePart'] = needed ;
					['CFrame'] = v[2]
				}
				,attachments[ v[6] or v[4] ]
				,needed
			)
		elseif placeMode == 2 then
			local needed1 = nil
			local s = os.clock()+2
			local cf1, cf2 = v[4], v[5]
			local attach1, attach2 = v[6], v[7]
			while needed1 == nil and os.clock()<s do
				for ii, vv in ipairs(placed[cf1]:GetDescendants()) do
					if vv:IsA('BasePart') and vv.Name == attachments[ attach1 ] then
						needed1 = vv
						break
					end
				end
				run.RenderStepped:Wait()
			end
			local needed2 = nil
			local s = os.clock()+2
			while needed2 == nil and os.clock()<s do
				for ii, vv in ipairs(placed[cf2]:GetDescendants()) do
					if vv:IsA('BasePart') and vv.Name == attachments[ attach2 ] then
						needed2 = vv
						break
					end
				end
				run.RenderStepped:Wait()
			end
			remote:FireServer(
				name
				,{
					[1]={ ['CFrame'] = needed1 };
					[2]= { ['CFrame'] = needed2 };
				}
			)
		elseif placeMode == 3 then
			local needed1 = nil
			local s = os.clock()+2
			local cf, basepart, attahment = v[2] , v[4], v[5]
			local attach1
			while needed1 == nil and os.clock()<s do
				for ii, vv in ipairs(placed[basepart]:GetDescendants()) do
					if vv:IsA('BasePart') and vv.Name == attachments[ attahment ] then
						needed1 = vv
						break
					end
				end
				run.RenderStepped:Wait()
			end
			remote:FireServer(
				name
				,{
					[1]={ ['CFrame'] = needed1 };
					[2]= { ['CFrame'] = cf, BasePart = base };
				}
			)
		end
		--if (model:GetPivot().Position-targetPos).Magnitude<= ( placeMode == 0 and 40 or 40 ) or (model:GetPivot().Position-base.Position).Magnitude <= areaRadius then
		local targetPos = (base.CFrame*v[2]).Position
		local found, s = false, os.clock()+60*5

		local con = structures.ChildAdded:Connect(function(model)
			if model.Name == name and not model:FindFirstChild('IsBlueprint') and not model:WaitForChild('IsBlueprint', .1) then
				
				local ss = os.clock()+2
				while ss>os.clock() and model.PrimaryPart == nil do run.RenderStepped:Wait() end
				if (model:GetPivot().Position-targetPos).Magnitude<= ( placeMode == 0 and 40 or 40 ) or (model:GetPivot().Position-ppos).Magnitude <= areaRadius then
					found = model
				end
			end
		end)
		repeat run.RenderStepped:Wait() until found~=false or os.clock()>s
		con:Disconnect()
		if found then
			placed[i] = found
		end
		
	end
end)

p:Destroy()

print(a, b)



