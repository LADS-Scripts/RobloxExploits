local lplr = game:GetService('Players').LocalPlayer

local ScreenGui = Instance.new("ScreenGui")
local ui = ScreenGui
ui.ResetOnSpawn = false
ui.Parent = game.CoreGui

local Frame = Instance.new("ImageLabel")
local SetTarget = Instance.new("TextButton")
local TextButton_Roundify_25px = Instance.new("ImageLabel")
local TextBox = Instance.new("TextBox")
local RangeBox = Instance.new("TextBox")

--Properties:
do
    ScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
    ScreenGui.ResetOnSpawn = false

    Frame.Name = "Frame"
    Frame.Parent = ScreenGui
    Frame.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    Frame.BackgroundTransparency = 1.000
    Frame.Position = UDim2.new(0.790069699, 0, 0.398671091, 0)
    Frame.Size = UDim2.new(0.176480845, 0, 0.113122962, 0)
    Frame.Image = "rbxassetid://3570695787"
    Frame.ScaleType = Enum.ScaleType.Slice
    Frame.SliceCenter = Rect.new(100, 100, 100, 100)
    Frame.SliceScale = 0.250

    SetTarget.Name = "SetTarget"
    SetTarget.Parent = Frame
    SetTarget.AnchorPoint = Vector2.new(0.5, 0)
    SetTarget.BackgroundColor3 = Color3.fromRGB(144, 144, 144)
    SetTarget.BackgroundTransparency = 1.000
    SetTarget.BorderColor3 = Color3.fromRGB(0, 0, 0)
    SetTarget.BorderSizePixel = 0
    SetTarget.Position = UDim2.new(0.5, 0, 0.670000017, 0)
    SetTarget.Size = UDim2.new(0.800000012, 2, 0.300000012, 0)
    SetTarget.ZIndex = 2
    SetTarget.Font = Enum.Font.SourceSans
    SetTarget.Text = "SetTarget"
    SetTarget.TextColor3 = Color3.fromRGB(255, 255, 255)
    SetTarget.TextScaled = true
    SetTarget.TextSize = 14.000
    SetTarget.TextStrokeTransparency = 0.000
    SetTarget.TextWrapped = true

    TextButton_Roundify_25px.Name = "TextButton_Roundify_25px"
    TextButton_Roundify_25px.Parent = SetTarget
    TextButton_Roundify_25px.Active = true
    TextButton_Roundify_25px.AnchorPoint = Vector2.new(0.5, 0.5)
    TextButton_Roundify_25px.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    TextButton_Roundify_25px.BackgroundTransparency = 1.000
    TextButton_Roundify_25px.Position = UDim2.new(0.5, 0, 0.5, 0)
    TextButton_Roundify_25px.Selectable = true
    TextButton_Roundify_25px.Size = UDim2.new(1, 0, 1, 0)
    TextButton_Roundify_25px.Image = "rbxassetid://3570695787"
    TextButton_Roundify_25px.ImageColor3 = Color3.fromRGB(144, 144, 144)
    TextButton_Roundify_25px.ScaleType = Enum.ScaleType.Slice
    TextButton_Roundify_25px.SliceCenter = Rect.new(100, 100, 100, 100)
    TextButton_Roundify_25px.SliceScale = 0.250

    TextBox.Parent = Frame
    TextBox.AnchorPoint = Vector2.new(0.5, 0)
    TextBox.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    TextBox.BorderColor3 = Color3.fromRGB(0, 0, 0)
    TextBox.BorderSizePixel = 0
    TextBox.Position = UDim2.new(0.5, 0, 0.0500002392, 0)
    TextBox.Size = UDim2.new(0.949999988, 0, 0.320432067, 0)
    TextBox.Font = Enum.Font.SourceSans
    TextBox.Text = "suckaniggadick"
    TextBox.TextColor3 = Color3.fromRGB(0, 0, 0)
    TextBox.TextScaled = true
    TextBox.TextSize = 14.000
    TextBox.TextWrapped = true

    RangeBox.Name = "RangeBox"
    RangeBox.Parent = Frame
    RangeBox.AnchorPoint = Vector2.new(0.5, 0)
    RangeBox.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    RangeBox.BorderColor3 = Color3.fromRGB(0, 0, 0)
    RangeBox.BorderSizePixel = 0
    RangeBox.Position = UDim2.new(0.5, 0, 0.340000004, 0)
    RangeBox.Size = UDim2.new(0.949999988, 0, 0.320432067, 0)
    RangeBox.Font = Enum.Font.SourceSans
    RangeBox.Text = "50"
    RangeBox.TextColor3 = Color3.fromRGB(0, 0, 0)
    RangeBox.TextScaled = true
    RangeBox.TextSize = 14.000
    RangeBox.TextWrapped = true
end

_G.destroyBoreUi = true
task.wait(2)
_G.destroyBoreUi = false

local getPiped = {'Bore', 'Well Pump', 'Artillery'}


local boreRange = 422

local function getDistance(pointA, pointB)
	return (pointA - pointB).Magnitude
end


local random = math.random
local localTeam = lplr.TeamColor

SetTarget.MouseButton1Click:Connect(function()
	local toFind = TextBox.Text:lower()
	local boreTargetDistance = tonumber(RangeBox.Text)
	
	local found = {}
	local charPos = lplr.Character.HumanoidRootPart.Position
	for i,v in next, workspace.Structures:GetChildren() do
		if v:GetAttribute('Team') == localTeam then continue end
		if not string.find(v.Name:lower(), toFind) then continue end
		
		local pp = v.PrimaryPart
		if not pp then continue end
		
		if getDistance(charPos, pp.Position)>boreRange+boreTargetDistance+10 then continue end
		
		if table.find(getPiped, v.Name) then
			pcall(table.insert, found, v.PipeFemale.FemaleFlange.Position)
		else
			local toadd = pp.Position
			for _, part in next, v:GetDescendants() do
				if part.Name == 'FemaleFlange' then
					toadd =part.Position
					break
				end
			end
			table.insert(found, toadd)
		end
	end
	
	if #found == 0 then
		warn('No bore targets found!')
		return
	end
	
	for _,v in next, workspace.Structures:GetChildren() do
		if v.Name ~= 'Bore' then continue end
		if v:GetAttribute('Team') ~= localTeam then continue end
		
		local pp = v.PrimaryPart
		if not pp then  continue end
		
		local distToBore = getDistance(charPos, pp.Position)
		if distToBore>=boreTargetDistance then continue end
		
		local panPos = v.PanAssembly.PanHead.Position
		
		local foundCln = {}
		for _, value in next, found do
			local dist = getDistance(value, panPos)
			if dist<=boreRange then
				table.insert(foundCln, value)
			end
		end
		
		if #foundCln == 0 then continue end
		
		local targetPos = foundCln[random(1, #foundCln)]
		targetPos+=Vector3.new(
			random(-45, 45)
			,random(-30, 30)
			,random(-45, 45)
		)/100

		v.SetTarget:FireServer(v, targetPos)
		task.wait(random(90, 200)/100)
	end
end)

repeat task.wait(1) until _G.destroyBoreUi == true
_G.destroyBoreUi = false
ui:Destroy()
